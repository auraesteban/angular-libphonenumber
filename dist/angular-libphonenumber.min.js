/**
 * angular-libphonenumber
 * Nathan Hammond's libphonenumber ported to an angular filter
 * @version v1.1.0
 * @link https://github.com/cwill747/angular-libphonenumber
 * @license Apache-2.0
 */
!function(e){e.module("cwill747.phonenumber",[]).directive("phoneNumber",["$log","$window",function(e,n){return{restrict:"A",require:"?ngModel",scope:{countryCode:"=",nonFormatted:"=?",extSymbol:"@"},controller:function(){this.countryCode=this.countryCode||"us"},link:function(t,r,o,u){function i(e){if(!e)return e;var n="([^0-9+"+d+"])",t=new RegExp(n,"g");return e.replace(t,"")}function l(e){var n=new RegExp(d,"g"),t=i(e).replace(n,""),r=t.match(/^(\+1|1)/g,""),o=e,u=r&&r.length?10+r[0].length:10,l="";return t.length>=10&&(o=t.substr(0,u),l=t.substr(u).replace(/[\D]/g,"")),{phoneNumber:o,extension:l}}function a(n,t){var r=n;try{var o=l(n);r=phoneUtils.formatAsTyped(o.phoneNumber,t),o.extension&&(r+=" "+d+o.extension)}catch(n){e.debug(n)}return r}function c(e){var n=i(e);t.nonFormatted=n;var r="";return r=n&&n.length>1?a(n,t.countryCode):n,r.trim()}function s(e){return u.$isEmpty(e)?e:a(i(e),t.countryCode)}function h(e){if(u.$isEmpty(e))return t.nonFormatted="",e;var n=c(e);if(n===e)return e;var r=p.selectionStart,o=p.selectionEnd+n.length-e.length;return e.length<n.length&&(r+=n.length-e.length),e.length>n.length+1&&(r-=n.length-e.length),u.$setViewValue(n),u.$render(),p.setSelectionRange(r,o),i(n)}function g(r){var o=!1;try{var i=l(r);o=n.phoneUtils.isValidNumberForRegion(i.phoneNumber,t.countryCode)}catch(n){e.debug(n)}var a=u.$isEmpty(r)||o;return u.$setValidity("phoneNumber",a),r}var p=r[0],d=t.extSymbol||"x";t.$watch("countryCode",function(){u.$modelValue=u.$viewValue+" "}),u.$formatters.push(s),u.$formatters.push(g),u.$parsers.push(h),u.$parsers.push(g)}}}])}(angular);
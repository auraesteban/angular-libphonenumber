/**
 * angular-libphonenumber
 * Nathan Hammond's libphonenumber ported to an angular filter
 * @version v1.1.0
 * @link https://github.com/cwill747/angular-libphonenumber
 * @license Apache-2.0
 */
!function(e){e.module("cwill747.phonenumber",[]).directive("phoneNumber",["$log","$window",function(e,t){return{restrict:"A",require:"?ngModel",scope:{countryCode:"=",nonFormatted:"=?",extSymbol:"@"},controller:function(){this.countryCode=this.countryCode||"us"},link:function(n,r,o,u){function i(e){if(!e)return e;var t="([^0-9|+|"+d+"])",n=new RegExp(t,"g");return e.replace(n,"")}function l(t,n){var r=t;try{var o=new RegExp(d,"g"),u=i(t).replace(o,""),l=u.match(/^(\+1|1)/g,""),c=t,a=l&&l.length?10+l[0].length:10,s="";u.length>=10&&(c=u.substring(0,a),s=u.substring(a)),r=phoneUtils.formatAsTyped(c,n),s&&(r+=" "+d+s)}catch(t){e.debug(t)}return r}function c(e){var t=i(e);n.nonFormatted=t;var r="";return r=t&&t.length>1?l(t,n.countryCode):t,r.trim()}function a(e){return u.$isEmpty(e)?e:l(i(e),n.countryCode)}function s(e){if(u.$isEmpty(e))return n.nonFormatted="",e;var t=c(e);if(t===e)return e;var r=g.selectionStart,o=g.selectionEnd+t.length-e.length;return e.length<t.length&&(r+=t.length-e.length),e.length>t.length+1&&(r-=t.length-e.length),u.$setViewValue(t),u.$render(),g.setSelectionRange(r,o),i(t)}function h(r){var o=!1;try{o=t.phoneUtils.isValidNumberForRegion(r,n.countryCode)}catch(t){e.debug(t)}var i=u.$isEmpty(r)||o;return u.$setValidity("phoneNumber",i),r}var g=r[0],d=n.extSymbol||"x";n.$watch("countryCode",function(){u.$modelValue=u.$viewValue+" "}),u.$formatters.push(a),u.$formatters.push(h),u.$parsers.push(s),u.$parsers.push(h)}}}])}(angular);